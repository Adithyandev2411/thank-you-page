<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gratitude Message</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      font-family: 'Cormorant Garamond', Georgia, serif;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }
    
    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeOutDown {
      from {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      to {
        opacity: 0;
        transform: translateY(-30px) scale(0.95);
      }
    }
    
    @keyframes heartBeat {
      0% { transform: scale(1); }
      14% { transform: scale(1.15); }
      28% { transform: scale(1); }
      42% { transform: scale(1.15); }
      70% { transform: scale(1); }
    }
    
    @keyframes letterReveal {
      0% {
        opacity: 0;
        transform: translateY(80px) rotateX(-90deg) scale(0);
      }
      50% {
        opacity: 1;
        transform: translateY(-15px) rotateX(10deg) scale(1.3);
      }
      70% {
        transform: translateY(5px) rotateX(-5deg) scale(0.95);
      }
      85% {
        transform: translateY(-3px) rotateX(2deg) scale(1.05);
      }
      100% {
        opacity: 1;
        transform: translateY(0) rotateX(0deg) scale(1);
      }
    }
    
    @keyframes popIn {
      0% {
        opacity: 0;
        transform: scale(0) rotate(-180deg);
      }
      50% {
        transform: scale(1.4) rotate(10deg);
      }
      70% {
        transform: scale(0.9) rotate(-5deg);
      }
      100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
      }
    }
    
    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3) translateY(100px);
      }
      40% {
        transform: scale(1.15) translateY(-30px);
      }
      60% {
        transform: scale(0.95) translateY(10px);
      }
      80% {
        transform: scale(1.05) translateY(-5px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    
    @keyframes explosionBurst {
      0% {
        opacity: 1;
        transform: scale(0);
      }
      50% {
        opacity: 1;
        transform: scale(1.5);
      }
      100% {
        opacity: 0;
        transform: scale(3);
      }
    }
    
    @keyframes confettiFall {
      0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(400px) rotate(720deg) scale(0);
      }
    }
    
    @keyframes starPop {
      0% {
        opacity: 0;
        transform: scale(0) rotate(0deg);
      }
      50% {
        opacity: 1;
        transform: scale(1.5) rotate(180deg);
      }
      100% {
        opacity: 0;
        transform: scale(0) rotate(360deg);
      }
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(4);
        opacity: 0;
      }
    }
    
    @keyframes wiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-10deg) scale(1.1); }
      75% { transform: rotate(10deg) scale(1.1); }
    }
    
    .pop-in {
      animation: popIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
    }
    
    .bounce-in {
      animation: bounceIn 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
    }
    
    .wiggle-hover:hover {
      animation: wiggle 0.5s ease-in-out;
    }
    
    .floating-shape {
      animation: float 6s ease-in-out infinite;
    }
    
    .floating-shape:nth-child(2) {
      animation-delay: -2s;
    }
    
    .floating-shape:nth-child(3) {
      animation-delay: -4s;
    }
    
    .sparkle {
      animation: sparkle 2s ease-in-out infinite;
    }
    
    .fade-in-up {
      animation: fadeInUp 0.8s ease-out forwards;
    }
    
    .fade-out-down {
      animation: fadeOutDown 0.6s ease-in forwards;
    }
    
    .heart-beat {
      animation: heartBeat 1.5s ease-in-out infinite;
      animation-delay: 0.5s;
    }
    
    .letter-reveal {
      display: inline-block;
      opacity: 0;
      animation: letterReveal 0.5s ease-out forwards;
    }
    
    .input-glow:focus {
      box-shadow: 0 0 0 4px rgba(199, 168, 199, 0.3);
    }
    
    .btn-shimmer {
      position: relative;
      overflow: hidden;
    }
    
    .btn-shimmer::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    .btn-shimmer:hover::before {
      left: 100%;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app-wrapper" class="h-full w-full overflow-auto relative"><!-- Floating decorative shapes -->
   <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <svg class="floating-shape absolute top-[10%] left-[10%] w-16 h-16 opacity-40" viewbox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="#d4a5d4" stroke-width="2" />
    </svg>
    <svg class="floating-shape absolute top-[20%] right-[15%] w-12 h-12 opacity-30" viewbox="0 0 100 100"><polygon points="50,10 90,90 10,90" fill="none" stroke="#a5c4d4" stroke-width="2" />
    </svg>
    <svg class="floating-shape absolute bottom-[25%] left-[20%] w-10 h-10 opacity-35" viewbox="0 0 100 100"><rect x="20" y="20" width="60" height="60" fill="none" stroke="#d4c4a5" stroke-width="2" rx="10" />
    </svg>
    <svg class="floating-shape absolute bottom-[15%] right-[10%] w-14 h-14 opacity-25" viewbox="0 0 100 100"><path d="M50 10 L61 40 L95 40 L68 60 L79 90 L50 70 L21 90 L32 60 L5 40 L39 40 Z" fill="none" stroke="#c4d4a5" stroke-width="2" />
    </svg><!-- Sparkles -->
    <div class="sparkle absolute top-[30%] left-[30%] w-2 h-2 bg-white rounded-full" style="animation-delay: 0s;"></div>
    <div class="sparkle absolute top-[50%] right-[25%] w-1.5 h-1.5 bg-white rounded-full" style="animation-delay: 0.7s;"></div>
    <div class="sparkle absolute bottom-[35%] left-[40%] w-2 h-2 bg-white rounded-full" style="animation-delay: 1.4s;"></div>
   </div><!-- Form Section -->
   <div id="form-section" class="h-full flex items-center justify-center px-6">
    <div class="text-center max-w-md w-full fade-in-up">
     <div class="mb-8">
      <svg class="w-16 h-16 mx-auto mb-6 opacity-70" viewbox="0 0 100 100"><path d="M50 88 C20 60, 10 40, 25 25 C35 15, 50 20, 50 35 C50 20, 65 15, 75 25 C90 40, 80 60, 50 88Z" fill="none" stroke="#c4a5b8" stroke-width="2.5" />
      </svg><label id="greeting-label" for="name-input" class="block text-2xl md:text-3xl font-medium tracking-wide mb-2" style="color: #6b5b6b;"> What's your name? </label>
      <p class="text-sm opacity-60" style="color: #8b7b8b;">Share a moment of gratitude</p>
     </div>
     <form id="name-form" class="space-y-6">
      <div class="relative"><input type="text" id="name-input" name="name" required autocomplete="off" placeholder="Enter your name..." class="w-full px-6 py-4 text-xl text-center rounded-2xl border-2 outline-none transition-all duration-300 input-glow" style="background: rgba(255,255,255,0.7); border-color: #d4c4d4; color: #5b4b5b;">
      </div><button type="submit" id="submit-btn" class="btn-shimmer wiggle-hover w-full py-4 px-8 text-xl font-medium rounded-2xl text-white transition-all duration-300 transform hover:scale-110 active:scale-95 shadow-lg hover:shadow-2xl" style="background: linear-gradient(135deg, #c4a5b8 0%, #a5b8c4 100%);"> Share </button>
     </form>
    </div>
   </div><!-- Thank You Section -->
   <div id="thank-section" class="h-full flex items-center justify-center px-6 hidden relative overflow-hidden"><!-- Confetti container -->
    <div id="confetti-container" class="absolute inset-0 pointer-events-none overflow-hidden"></div><!-- Explosion rings -->
    <div id="explosion-rings" class="absolute inset-0 flex items-center justify-center pointer-events-none"></div><!-- Stars burst -->
    <div id="stars-burst" class="absolute inset-0 pointer-events-none"></div>
    <div class="text-center max-w-lg w-full relative z-10">
     <div id="heart-container" class="mb-8 opacity-0">
      <svg class="w-24 h-24 mx-auto heart-beat" viewbox="0 0 100 100"><path d="M50 88 C20 60, 10 40, 25 25 C35 15, 50 20, 50 35 C50 20, 65 15, 75 25 C90 40, 80 60, 50 88Z" fill="#c4a5b8" opacity="0.9" />
      </svg>
     </div>
     <p id="thank-prefix" class="text-xl md:text-2xl mb-4 opacity-0" style="color: #7b6b7b; font-style: italic;">Thank you for being in my life,</p>
     <h1 id="thank-name" class="text-4xl md:text-5xl lg:text-6xl font-semibold mb-6" style="color: #5b4b5b; perspective: 1000px;"><!-- Name will be inserted here with animation --></h1>
     <div id="sparkle-row" class="flex justify-center gap-3 mt-8 opacity-0"><span class="w-3 h-3 rounded-full sparkle" style="background: #c4a5b8; animation-delay: 0s;"></span> <span class="w-3 h-3 rounded-full sparkle" style="background: #a5b8c4; animation-delay: 0.3s;"></span> <span class="w-3 h-3 rounded-full sparkle" style="background: #b8c4a5; animation-delay: 0.6s;"></span> <span class="w-3 h-3 rounded-full sparkle" style="background: #d4c4a5; animation-delay: 0.9s;"></span> <span class="w-3 h-3 rounded-full sparkle" style="background: #c4d4a5; animation-delay: 1.2s;"></span>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      greeting_text: "What's your name?",
      thank_you_prefix: "Thank you for being in my life,",
      button_text: "Share",
      background_color: "#faf5f8",
      surface_color: "#ffffff",
      text_color: "#5b4b5b",
      primary_action_color: "#c4a5b8",
      secondary_action_color: "#a5b8c4"
    };
    
    let config = { ...defaultConfig };
    
    function createConfetti() {
      const container = document.getElementById('confetti-container');
      const colors = ['#c4a5b8', '#a5b8c4', '#b8c4a5', '#d4c4a5', '#c4d4a5', '#f0b8d0', '#b8d0f0'];
      const shapes = ['circle', 'square', 'triangle'];
      
      for (let i = 0; i < 60; i++) {
        const confetti = document.createElement('div');
        const shape = shapes[Math.floor(Math.random() * shapes.length)];
        const color = colors[Math.floor(Math.random() * colors.length)];
        const size = Math.random() * 12 + 6;
        const left = Math.random() * 100;
        const delay = Math.random() * 0.5;
        const duration = Math.random() * 2 + 2;
        
        confetti.style.cssText = `
          position: absolute;
          top: -20px;
          left: ${left}%;
          width: ${size}px;
          height: ${size}px;
          background: ${color};
          opacity: 0;
          animation: confettiFall ${duration}s ease-out ${delay}s forwards;
        `;
        
        if (shape === 'circle') {
          confetti.style.borderRadius = '50%';
        } else if (shape === 'triangle') {
          confetti.style.width = '0';
          confetti.style.height = '0';
          confetti.style.background = 'transparent';
          confetti.style.borderLeft = `${size/2}px solid transparent`;
          confetti.style.borderRight = `${size/2}px solid transparent`;
          confetti.style.borderBottom = `${size}px solid ${color}`;
        }
        
        container.appendChild(confetti);
      }
    }
    
    function createExplosionRings() {
      const container = document.getElementById('explosion-rings');
      const colors = ['#c4a5b8', '#a5b8c4', '#b8c4a5'];
      
      for (let i = 0; i < 3; i++) {
        const ring = document.createElement('div');
        ring.style.cssText = `
          position: absolute;
          width: 100px;
          height: 100px;
          border: 4px solid ${colors[i]};
          border-radius: 50%;
          opacity: 0;
          animation: ripple 1.5s ease-out ${i * 0.2}s forwards;
        `;
        container.appendChild(ring);
      }
    }
    
    function createStarsBurst() {
      const container = document.getElementById('stars-burst');
      const colors = ['#c4a5b8', '#a5b8c4', '#b8c4a5', '#ffd700', '#ff69b4'];
      
      for (let i = 0; i < 20; i++) {
        const star = document.createElement('div');
        const angle = (i / 20) * 360;
        const distance = Math.random() * 150 + 100;
        const color = colors[Math.floor(Math.random() * colors.length)];
        const size = Math.random() * 20 + 10;
        const delay = Math.random() * 0.3;
        
        const x = Math.cos(angle * Math.PI / 180) * distance;
        const y = Math.sin(angle * Math.PI / 180) * distance;
        
        star.innerHTML = `<svg viewBox="0 0 100 100" style="width:${size}px;height:${size}px;"><path d="M50 5 L61 40 L95 40 L68 60 L79 95 L50 75 L21 95 L32 60 L5 40 L39 40 Z" fill="${color}"/></svg>`;
        star.style.cssText = `
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%) translate(${x}px, ${y}px);
          opacity: 0;
          animation: starPop 1s ease-out ${delay}s forwards;
        `;
        container.appendChild(star);
      }
    }
    
    function animateName(name) {
      const container = document.getElementById('thank-name');
      container.innerHTML = '';
      
      const chars = name.split('');
      chars.forEach((char, index) => {
        const span = document.createElement('span');
        span.className = 'letter-reveal';
        span.style.animationDelay = `${index * 0.12}s`;
        span.style.display = 'inline-block';
        span.style.transformStyle = 'preserve-3d';
        span.textContent = char === ' ' ? '\u00A0' : char;
        container.appendChild(span);
      });
      
      // Add exclamation mark with extra bounce
      const exclaim = document.createElement('span');
      exclaim.className = 'letter-reveal';
      exclaim.style.animationDelay = `${chars.length * 0.12}s`;
      exclaim.style.display = 'inline-block';
      exclaim.textContent = '!';
      container.appendChild(exclaim);
    }
    
    function showThankYou(name) {
      const formSection = document.getElementById('form-section');
      const thankSection = document.getElementById('thank-section');
      
      formSection.classList.add('fade-out-down');
      
      setTimeout(() => {
        formSection.classList.add('hidden');
        formSection.classList.remove('fade-out-down');
        
        thankSection.classList.remove('hidden');
        
        // Trigger explosion effects
        createConfetti();
        createExplosionRings();
        createStarsBurst();
        
        // Animate heart with pop
        const heart = document.getElementById('heart-container');
        heart.style.opacity = '1';
        heart.classList.add('pop-in');
        
        // Animate prefix text
        setTimeout(() => {
          const prefix = document.getElementById('thank-prefix');
          prefix.style.opacity = '1';
          prefix.classList.add('bounce-in');
        }, 400);
        
        // Animate name
        setTimeout(() => {
          animateName(name);
        }, 700);
        
        // Animate sparkle row
        setTimeout(() => {
          const sparkles = document.getElementById('sparkle-row');
          sparkles.style.opacity = '1';
          sparkles.classList.add('bounce-in');
        }, 1500);
        
      }, 600);
    }
    
    document.getElementById('name-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('name-input').value.trim();
      if (name) {
        showThankYou(name);
      }
    });
    
    async function onConfigChange(cfg) {
      config = { ...defaultConfig, ...cfg };
      
      // Update background
      document.getElementById('app-wrapper').style.background = `linear-gradient(135deg, ${config.background_color} 0%, ${adjustColor(config.background_color, -10)} 100%)`;
      
      // Update text content
      document.getElementById('greeting-label').textContent = config.greeting_text || defaultConfig.greeting_text;
      document.getElementById('thank-prefix').textContent = config.thank_you_prefix || defaultConfig.thank_you_prefix;
      document.getElementById('submit-btn').textContent = config.button_text || defaultConfig.button_text;
      
      // Update colors
      document.getElementById('greeting-label').style.color = config.text_color;
      document.getElementById('thank-prefix').style.color = adjustColor(config.text_color, 20);
      document.getElementById('thank-name').style.color = config.text_color;
      
      // Update button gradient
      document.getElementById('submit-btn').style.background = `linear-gradient(135deg, ${config.primary_action_color} 0%, ${config.secondary_action_color} 100%)`;
      
      // Update input styling
      const input = document.getElementById('name-input');
      input.style.backgroundColor = hexToRgba(config.surface_color, 0.7);
      input.style.borderColor = adjustColor(config.primary_action_color, 20);
      input.style.color = config.text_color;
    }
    
    function adjustColor(hex, percent) {
      const num = parseInt(hex.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.min(255, Math.max(0, (num >> 16) + amt));
      const G = Math.min(255, Math.max(0, ((num >> 8) & 0x00FF) + amt));
      const B = Math.min(255, Math.max(0, (num & 0x0000FF) + amt));
      return '#' + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
    }
    
    function hexToRgba(hex, alpha) {
      const num = parseInt(hex.replace('#', ''), 16);
      const r = (num >> 16) & 255;
      const g = (num >> 8) & 255;
      const b = num & 255;
      return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }
    
    function mapToCapabilities(cfg) {
      return {
        recolorables: [
          {
            get: () => cfg.background_color || defaultConfig.background_color,
            set: (value) => { cfg.background_color = value; window.elementSdk.setConfig({ background_color: value }); }
          },
          {
            get: () => cfg.surface_color || defaultConfig.surface_color,
            set: (value) => { cfg.surface_color = value; window.elementSdk.setConfig({ surface_color: value }); }
          },
          {
            get: () => cfg.text_color || defaultConfig.text_color,
            set: (value) => { cfg.text_color = value; window.elementSdk.setConfig({ text_color: value }); }
          },
          {
            get: () => cfg.primary_action_color || defaultConfig.primary_action_color,
            set: (value) => { cfg.primary_action_color = value; window.elementSdk.setConfig({ primary_action_color: value }); }
          },
          {
            get: () => cfg.secondary_action_color || defaultConfig.secondary_action_color,
            set: (value) => { cfg.secondary_action_color = value; window.elementSdk.setConfig({ secondary_action_color: value }); }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => cfg.font_family || defaultConfig.font_family,
          set: (value) => { cfg.font_family = value; window.elementSdk.setConfig({ font_family: value }); }
        },
        fontSizeable: {
          get: () => cfg.font_size || 16,
          set: (value) => { cfg.font_size = value; window.elementSdk.setConfig({ font_size: value }); }
        }
      };
    }
    
    function mapToEditPanelValues(cfg) {
      return new Map([
        ['greeting_text', cfg.greeting_text || defaultConfig.greeting_text],
        ['thank_you_prefix', cfg.thank_you_prefix || defaultConfig.thank_you_prefix],
        ['button_text', cfg.button_text || defaultConfig.button_text]
      ]);
    }
    
    // Initialize SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    } else {
      onConfigChange(defaultConfig);
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aff66b971787f8b',t:'MTc2NjA2ODY3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>